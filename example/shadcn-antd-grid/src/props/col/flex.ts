import { Breakpoint, breakpointAntdToTW } from '../breakpoint';

export type Flex = number | LiteralUnion<'none' | 'auto'>;
export type FlexProp = Flex | Partial<Record<Breakpoint, Flex>> | undefined

/** https://github.com/Microsoft/TypeScript/issues/29729 */
export type LiteralUnion<T extends string> = T | (string & {});

function parseFlex(flex: Flex): string {
  if (typeof flex === 'number') {
    return `${flex}_${flex}_auto`;
  }

  if (/^\d+(\.\d+)?(px|em|rem|%)$/.test(flex)) {
    return `0_0_${flex}`;
  }

  return flex.replace(/ /g, '_');
}

function flexToTWClass(flexValue: string){
  return `flex-[${flexValue}]`;
}

export function flexAntdToTW(flex: FlexProp) {
  const flexClass = !flex ? '' : typeof flex !== 'object'
    ? flexToTWClass(parseFlex(flex))
    : Object.entries(flex || {}).map(([breakpoint, flexValue]) => {
      return `${breakpointAntdToTW(breakpoint)}:${flexToTWClass(parseFlex(flexValue))}`;
    }).join(' ');

  return flexClass;
}

// flex-[0_0_auto]
// flex-[1_1_auto]
// flex-[1_1_0%]
// flex-[0_1_auto]

// xs:flex-[0_0_auto]
// sm:flex-[0_0_auto]
// md:flex-[0_0_auto]
// lg:flex-[0_0_auto]
// xl:flex-[0_0_auto]
// 2xl:flex-[0_0_auto]

// xs:flex-[1_0_auto]
// sm:flex-[1_0_auto]
// md:flex-[1_0_auto]
// lg:flex-[1_0_auto]
// xl:flex-[1_0_auto]
// 2xl:flex-[1_0_auto]

// xs:flex-[0_1_auto]
// sm:flex-[0_1_auto]
// md:flex-[0_1_auto]
// lg:flex-[0_1_auto]
// xl:flex-[0_1_auto]
// 2xl:flex-[0_1_auto]

// xs:flex-[1_1_auto]
// sm:flex-[1_1_auto]
// md:flex-[1_1_auto]
// lg:flex-[1_1_auto]
// xl:flex-[1_1_auto]
// 2xl:flex-[1_1_auto]

// xs:flex-[1_1_10%]
// sm:flex-[1_1_10%]
// md:flex-[1_1_10%]
// lg:flex-[1_1_10%]
// xl:flex-[1_1_10%]
// 2xl:flex-[1_1_10%]

// xs:flex-[1_1_20%]
// sm:flex-[1_1_20%]
// md:flex-[1_1_20%]
// lg:flex-[1_1_20%]
// xl:flex-[1_1_20%]
// 2xl:flex-[1_1_20%]

// xs:flex-[1_1_30%]
// sm:flex-[1_1_30%]
// md:flex-[1_1_30%]
// lg:flex-[1_1_30%]
// xl:flex-[1_1_30%]
// 2xl:flex-[1_1_30%]

// xs:flex-[1_1_40%]
// sm:flex-[1_1_40%]
// md:flex-[1_1_40%]
// lg:flex-[1_1_40%]
// xl:flex-[1_1_40%]
// 2xl:flex-[1_1_40%]

// xs:flex-[1_1_50%]
// sm:flex-[1_1_50%]
// md:flex-[1_1_50%]
// lg:flex-[1_1_50%]
// xl:flex-[1_1_50%]
// 2xl:flex-[1_1_50%]

// xs:flex-[1_1_60%]
// sm:flex-[1_1_60%]
// md:flex-[1_1_60%]
// lg:flex-[1_1_60%]
// xl:flex-[1_1_60%]
// 2xl:flex-[1_1_60%]

// xs:flex-[1_1_70%]
// sm:flex-[1_1_70%]
// md:flex-[1_1_70%]
// lg:flex-[1_1_70%]
// xl:flex-[1_1_70%]
// 2xl:flex-[1_1_70%]

// xs:flex-[1_1_80%]
// sm:flex-[1_1_80%]
// md:flex-[1_1_80%]
// lg:flex-[1_1_80%]
// xl:flex-[1_1_80%]
// 2xl:flex-[1_1_80%]

// xs:flex-[1_1_90%]
// sm:flex-[1_1_90%]
// md:flex-[1_1_90%]
// lg:flex-[1_1_90%]
// xl:flex-[1_1_90%]
// 2xl:flex-[1_1_90%]

// xs:flex-[1_1_100%]
// sm:flex-[1_1_100%]
// md:flex-[1_1_100%]
// lg:flex-[1_1_100%]
// xl:flex-[1_1_100%]
// 2xl:flex-[1_1_100%]


// xs:flex-[1_0_10%]
// sm:flex-[1_0_10%]
// md:flex-[1_0_10%]
// lg:flex-[1_0_10%]
// xl:flex-[1_0_10%]
// 2xl:flex-[1_0_10%]

// xs:flex-[1_0_20%]
// sm:flex-[1_0_20%]
// md:flex-[1_0_20%]
// lg:flex-[1_0_20%]
// xl:flex-[1_0_20%]
// 2xl:flex-[1_0_20%]

// xs:flex-[1_0_30%]
// sm:flex-[1_0_30%]
// md:flex-[1_0_30%]
// lg:flex-[1_0_30%]
// xl:flex-[1_0_30%]
// 2xl:flex-[1_0_30%]

// xs:flex-[1_0_40%]
// sm:flex-[1_0_40%]
// md:flex-[1_0_40%]
// lg:flex-[1_0_40%]
// xl:flex-[1_0_40%]
// 2xl:flex-[1_0_40%]

// xs:flex-[1_0_50%]
// sm:flex-[1_0_50%]
// md:flex-[1_0_50%]
// lg:flex-[1_0_50%]
// xl:flex-[1_0_50%]
// 2xl:flex-[1_0_50%]

// xs:flex-[1_0_60%]
// sm:flex-[1_0_60%]
// md:flex-[1_0_60%]
// lg:flex-[1_0_60%]
// xl:flex-[1_0_60%]
// 2xl:flex-[1_0_60%]

// xs:flex-[1_0_70%]
// sm:flex-[1_0_70%]
// md:flex-[1_0_70%]
// lg:flex-[1_0_70%]
// xl:flex-[1_0_70%]
// 2xl:flex-[1_0_70%]

// xs:flex-[1_0_80%]
// sm:flex-[1_0_80%]
// md:flex-[1_0_80%]
// lg:flex-[1_0_80%]
// xl:flex-[1_0_80%]
// 2xl:flex-[1_0_80%]

// xs:flex-[1_0_90%]
// sm:flex-[1_0_90%]
// md:flex-[1_0_90%]
// lg:flex-[1_0_90%]
// xl:flex-[1_0_90%]
// 2xl:flex-[1_0_90%]

// xs:flex-[1_0_100%]
// sm:flex-[1_0_100%]
// md:flex-[1_0_100%]
// lg:flex-[1_0_100%]
// xl:flex-[1_0_100%]
// 2xl:flex-[1_0_100%]


// xs:flex-[0_1_10%]
// sm:flex-[0_1_10%]
// md:flex-[0_1_10%]
// lg:flex-[0_1_10%]
// xl:flex-[0_1_10%]
// 2xl:flex-[0_1_10%]

// xs:flex-[0_1_20%]
// sm:flex-[0_1_20%]
// md:flex-[0_1_20%]
// lg:flex-[0_1_20%]
// xl:flex-[0_1_20%]
// 2xl:flex-[0_1_20%]

// xs:flex-[0_1_30%]
// sm:flex-[0_1_30%]
// md:flex-[0_1_30%]
// lg:flex-[0_1_30%]
// xl:flex-[0_1_30%]
// 2xl:flex-[0_1_30%]

// xs:flex-[0_1_40%]
// sm:flex-[0_1_40%]
// md:flex-[0_1_40%]
// lg:flex-[0_1_40%]
// xl:flex-[0_1_40%]
// 2xl:flex-[0_1_40%]

// xs:flex-[0_1_50%]
// sm:flex-[0_1_50%]
// md:flex-[0_1_50%]
// lg:flex-[0_1_50%]
// xl:flex-[0_1_50%]
// 2xl:flex-[0_1_50%]

// xs:flex-[0_1_60%]
// sm:flex-[0_1_60%]
// md:flex-[0_1_60%]
// lg:flex-[0_1_60%]
// xl:flex-[0_1_60%]
// 2xl:flex-[0_1_60%]

// xs:flex-[0_1_70%]
// sm:flex-[0_1_70%]
// md:flex-[0_1_70%]
// lg:flex-[0_1_70%]
// xl:flex-[0_1_70%]
// 2xl:flex-[0_1_70%]

// xs:flex-[0_1_80%]
// sm:flex-[0_1_80%]
// md:flex-[0_1_80%]
// lg:flex-[0_1_80%]
// xl:flex-[0_1_80%]
// 2xl:flex-[0_1_80%]

// xs:flex-[0_1_90%]
// sm:flex-[0_1_90%]
// md:flex-[0_1_90%]
// lg:flex-[0_1_90%]
// xl:flex-[0_1_90%]
// 2xl:flex-[0_1_90%]

// xs:flex-[0_1_100%]
// sm:flex-[0_1_100%]
// md:flex-[0_1_100%]
// lg:flex-[0_1_100%]
// xl:flex-[0_1_100%]
// 2xl:flex-[0_1_100%]

// xs:flex-[0_0_10%]
// sm:flex-[0_0_10%]
// md:flex-[0_0_10%]
// lg:flex-[0_0_10%]
// xl:flex-[0_0_10%]
// 2xl:flex-[0_0_10%]

// xs:flex-[0_0_20%]
// sm:flex-[0_0_20%]
// md:flex-[0_0_20%]
// lg:flex-[0_0_20%]
// xl:flex-[0_0_20%]
// 2xl:flex-[0_0_20%]

// xs:flex-[0_0_30%]
// sm:flex-[0_0_30%]
// md:flex-[0_0_30%]
// lg:flex-[0_0_30%]
// xl:flex-[0_0_30%]
// 2xl:flex-[0_0_30%]

// xs:flex-[0_0_40%]
// sm:flex-[0_0_40%]
// md:flex-[0_0_40%]
// lg:flex-[0_0_40%]
// xl:flex-[0_0_40%]
// 2xl:flex-[0_0_40%]

// xs:flex-[0_0_50%]
// sm:flex-[0_0_50%]
// md:flex-[0_0_50%]
// lg:flex-[0_0_50%]
// xl:flex-[0_0_50%]
// 2xl:flex-[0_0_50%]

// xs:flex-[0_0_60%]
// sm:flex-[0_0_60%]
// md:flex-[0_0_60%]
// lg:flex-[0_0_60%]
// xl:flex-[0_0_60%]
// 2xl:flex-[0_0_60%]

// xs:flex-[0_0_70%]
// sm:flex-[0_0_70%]
// md:flex-[0_0_70%]
// lg:flex-[0_0_70%]
// xl:flex-[0_0_70%]
// 2xl:flex-[0_0_70%]

// xs:flex-[0_0_80%]
// sm:flex-[0_0_80%]
// md:flex-[0_0_80%]
// lg:flex-[0_0_80%]
// xl:flex-[0_0_80%]
// 2xl:flex-[0_0_80%]

// xs:flex-[0_0_90%]
// sm:flex-[0_0_90%]
// md:flex-[0_0_90%]
// lg:flex-[0_0_90%]
// xl:flex-[0_0_90%]
// 2xl:flex-[0_0_90%]

// xs:flex-[0_0_100%]
// sm:flex-[0_0_100%]
// md:flex-[0_0_100%]
// lg:flex-[0_0_100%]
// xl:flex-[0_0_100%]
// 2xl:flex-[0_0_100%]


// flex-[0_0_4.16%]
// xs:flex-[0_0_4.16%]
// sm:flex-[0_0_4.16%]
// md:flex-[0_0_4.16%]
// lg:flex-[0_0_4.16%]
// xl:flex-[0_0_4.16%]
// 2xl:flex-[0_0_4.16%]

// flex-[0_0_8.33%]
// xs:flex-[0_0_8.33%]
// sm:flex-[0_0_8.33%]
// md:flex-[0_0_8.33%]
// lg:flex-[0_0_8.33%]
// xl:flex-[0_0_8.33%]
// 2xl:flex-[0_0_8.33%]

// flex-[0_0_12.5%]
// xs:flex-[0_0_12.5%]
// sm:flex-[0_0_12.5%]
// md:flex-[0_0_12.5%]
// lg:flex-[0_0_12.5%]
// xl:flex-[0_0_12.5%]
// 2xl:flex-[0_0_12.5%]

// flex-[0_0_16.66%]
// xs:flex-[0_0_16.66%]
// sm:flex-[0_0_16.66%]
// md:flex-[0_0_16.66%]
// lg:flex-[0_0_16.66%]
// xl:flex-[0_0_16.66%]
// 2xl:flex-[0_0_16.66%]

// flex-[0_0_20.83%]
// xs:flex-[0_0_20.83%]
// sm:flex-[0_0_20.83%]
// md:flex-[0_0_20.83%]
// lg:flex-[0_0_20.83%]
// xl:flex-[0_0_20.83%]
// 2xl:flex-[0_0_20.83%]

// flex-[0_0_25%]
// xs:flex-[0_0_25%]
// sm:flex-[0_0_25%]
// md:flex-[0_0_25%]
// lg:flex-[0_0_25%]
// xl:flex-[0_0_25%]
// 2xl:flex-[0_0_25%]

// flex-[0_0_29.16%]
// xs:flex-[0_0_29.16%]
// sm:flex-[0_0_29.16%]
// md:flex-[0_0_29.16%]
// lg:flex-[0_0_29.16%]
// xl:flex-[0_0_29.16%]
// 2xl:flex-[0_0_29.16%]

// flex-[0_0_29.16%]
// xs:flex-[0_0_29.16%]
// sm:flex-[0_0_29.16%]
// md:flex-[0_0_29.16%]
// lg:flex-[0_0_29.16%]
// xl:flex-[0_0_29.16%]
// 2xl:flex-[0_0_29.16%]

// flex-[0_0_33.33%]
// xs:flex-[0_0_33.33%]
// sm:flex-[0_0_33.33%]
// md:flex-[0_0_33.33%]
// lg:flex-[0_0_33.33%]
// xl:flex-[0_0_33.33%]
// 2xl:flex-[0_0_33.33%]

// flex-[0_0_37.5%]
// xs:flex-[0_0_37.5%]
// sm:flex-[0_0_37.5%]
// md:flex-[0_0_37.5%]
// lg:flex-[0_0_37.5%]
// xl:flex-[0_0_37.5%]
// 2xl:flex-[0_0_37.5%]

// flex-[0_0_41.66%]
// xs:flex-[0_0_41.66%]
// sm:flex-[0_0_41.66%]
// md:flex-[0_0_41.66%]
// lg:flex-[0_0_41.66%]
// xl:flex-[0_0_41.66%]
// 2xl:flex-[0_0_41.66%]

// flex-[0_0_50%]
// xs:flex-[0_0_50%]
// sm:flex-[0_0_50%]
// md:flex-[0_0_50%]
// lg:flex-[0_0_50%]
// xl:flex-[0_0_50%]
// 2xl:flex-[0_0_50%]

// flex-[0_0_54.16%]
// xs:flex-[0_0_54.16%]
// sm:flex-[0_0_54.16%]
// md:flex-[0_0_54.16%]
// lg:flex-[0_0_54.16%]
// xl:flex-[0_0_54.16%]
// 2xl:flex-[0_0_54.16%]

// flex-[0_0_58.33%]
// xs:flex-[0_0_58.33%]
// sm:flex-[0_0_58.33%]
// md:flex-[0_0_58.33%]
// lg:flex-[0_0_58.33%]
// xl:flex-[0_0_58.33%]
// 2xl:flex-[0_0_58.33%]

// flex-[0_0_62.5%]
// xs:flex-[0_0_62.5%]
// sm:flex-[0_0_62.5%]
// md:flex-[0_0_62.5%]
// lg:flex-[0_0_62.5%]
// xl:flex-[0_0_62.5%]
// 2xl:flex-[0_0_62.5%]

// flex-[0_0_66.66%]
// xs:flex-[0_0_66.66%]
// sm:flex-[0_0_66.66%]
// md:flex-[0_0_66.66%]
// lg:flex-[0_0_66.66%]
// xl:flex-[0_0_66.66%]
// 2xl:flex-[0_0_66.66%]

// flex-[0_0_70.83%]
// xs:flex-[0_0_70.83%]
// sm:flex-[0_0_70.83%]
// md:flex-[0_0_70.83%]
// lg:flex-[0_0_70.83%]
// xl:flex-[0_0_70.83%]
// 2xl:flex-[0_0_70.83%]

// flex-[0_0_75%]
// xs:flex-[0_0_75%]
// sm:flex-[0_0_75%]
// md:flex-[0_0_75%]
// lg:flex-[0_0_75%]
// xl:flex-[0_0_75%]
// 2xl:flex-[0_0_75%]

// flex-[0_0_79.16%]
// xs:flex-[0_0_79.16%]
// sm:flex-[0_0_79.16%]
// md:flex-[0_0_79.16%]
// lg:flex-[0_0_79.16%]
// xl:flex-[0_0_79.16%]
// 2xl:flex-[0_0_79.16%]

// flex-[0_0_83.33%]
// xs:flex-[0_0_83.33%]
// sm:flex-[0_0_83.33%]
// md:flex-[0_0_83.33%]
// lg:flex-[0_0_83.33%]
// xl:flex-[0_0_83.33%]
// 2xl:flex-[0_0_83.33%]

// flex-[0_0_87.5%]
// xs:flex-[0_0_87.5%]
// sm:flex-[0_0_87.5%]
// md:flex-[0_0_87.5%]
// lg:flex-[0_0_87.5%]
// xl:flex-[0_0_87.5%]
// 2xl:flex-[0_0_87.5%]

// flex-[0_0_91.66%]
// xs:flex-[0_0_91.66%]
// sm:flex-[0_0_91.66%]
// md:flex-[0_0_91.66%]
// lg:flex-[0_0_91.66%]
// xl:flex-[0_0_91.66%]
// 2xl:flex-[0_0_91.66%]

// flex-[0_0_95.83%]
// xs:flex-[0_0_95.83%]
// sm:flex-[0_0_95.83%]
// md:flex-[0_0_95.83%]
// lg:flex-[0_0_95.83%]
// xl:flex-[0_0_95.83%]
// 2xl:flex-[0_0_95.83%]

// flex-[0_0_100%]
// xs:flex-[0_0_100%]
// sm:flex-[0_0_100%]
// md:flex-[0_0_100%]
// lg:flex-[0_0_100%]
// xl:flex-[0_0_100%]
// 2xl:flex-[0_0_100%]